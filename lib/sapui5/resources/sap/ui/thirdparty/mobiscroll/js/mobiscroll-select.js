/*!
 * jQuery MobiScroll v2.3
 * http://mobiscroll.com
 *
 * Copyright 2010-2011, Acid Media
 * Licensed under the MIT license.
 *
 */
(function($){var a={inputClass:'',invalid:[],rtl:false,group:false,groupLabel:'Groups'};$.mobiscroll.presetShort('select');$.mobiscroll.presets.select=function(b){var c=b.settings,s=$.extend({},a,c),e=$(this),o=e.val(),g=e.find('option[value="'+e.val()+'"]').parent(),p=g.index()+'',f=p,h,j=this.id+'_dummy',l=$('label[for="'+this.id+'"]').attr('for',j),k=$('label[for="'+j+'"]'),m=s.label!==undefined?s.label:(k.length?k.text():e.attr('name')),n=[],q={},r,u,x=c.readonly,w;function y(d){if(d){return d.replace(/_/,'')}return''}function z(){var d,i=0,t={},w=[{}];if(s.group){if(s.rtl){i=1}$('optgroup',e).each(function(v){t['_'+v]=$(this).attr('label')});w[i]={};w[i][s.groupLabel]=t;d=g;i+=(s.rtl?-1:1)}else{d=e}w[i]={};w[i][m]={};$('option',d).each(function(){var v=$(this).attr('value');w[i][m]['_'+v]=$(this).text();if($(this).prop('disabled')){n.push(v)}});return w}if(s.group&&!$('optgroup',e).length){s.group=false}if(!s.invalid.length){s.invalid=n}if(s.group){if(s.rtl){r=1;u=0}else{r=0;u=1}}else{r=-1;u=0}$('#'+j).remove();$('option',e).each(function(){q[$(this).attr('value')]=$(this).text()});var A=$('<input type="text" id="'+j+'" value="'+q[e.val()]+'" class="'+s.inputClass+'" readonly />').insertBefore(e);if(s.showOnFocus){A.focus(function(){b.show()})}e.bind('change',function(){if(!h&&o!=e.val()){b.setSelectVal([e.val()],true)}h=false}).hide().closest('.ui-field-contain').trigger('create');b.setSelectVal=function(d,i,t){o=d[0];if(s.group){g=e.find('option[value="'+o+'"]').parent();f=g.index();b.temp=s.rtl?['_'+o,'_'+g.index()]:['_'+g.index(),'_'+o];if(f!==p){c.wheels=z();b.changeWheel([u]);p=f+''}}else{b.temp=['_'+o]}b.setValue(true,i,t);if(i){A.val(q[o]);var v=o!==e.val();e.val(o);if(v){e.trigger('change')}}};b.getSelectVal=function(t){var v=t?b.temp:b.values;return y(v[u])};return{width:50,wheels:w,headerText:false,anchor:A,formatResult:function(d){return q[y(d[u])]},parseValue:function(){o=e.val();g=e.find('option[value="'+o+'"]').parent();f=g.index();return s.group&&s.rtl?['_'+o,'_'+f]:s.group?['_'+f,'_'+o]:['_'+o]},validate:function(d,i){if(i===r){f=y(b.temp[r]);if(f!==p){g=e.find('optgroup').eq(f);f=g.index();o=g.find('option').eq(0).val();o=o||e.val();c.wheels=z();if(s.group){b.temp=s.rtl?['_'+o,'_'+f]:['_'+f,'_'+o];b.changeWheel([u]);p=f+''}}c.readonly=x}else{o=y(b.temp[u])}var t=$('ul',d).eq(u);$.each(s.invalid,function(i,v){$('li[data-val="_'+v+'"]',t).removeClass('dw-v')})},onAnimStart:function(i){if(i===r){c.readonly=[s.rtl,!s.rtl]}},onBeforeShow:function(){c.wheels=z();if(s.group){b.temp=s.rtl?['_'+o,'_'+g.index()]:['_'+g.index(),'_'+o]}},onSelect:function(v){A.val(v);h=true;e.val(y(b.values[u])).trigger('change');if(s.group){b.values=null}},onCancel:function(){if(s.group){b.values=null}},onChange:function(v){if(s.display=='inline'){A.val(v);h=true;e.val(y(b.temp[u])).trigger('change')}},onClose:function(){A.blur()},methods:{setValue:function(d,i,t){return this.each(function(){var b=$(this).mobiscroll('getInst');if(b){if(b.setSelectVal){b.setSelectVal(d,i,t)}else{b.temp=d;b.setValue(true,i,t)}}})},getValue:function(t){var b=$(this).mobiscroll('getInst');if(b){if(b.getSelectVal){return b.getSelectVal(t)}return b.values}}}}}})(jQuery);
