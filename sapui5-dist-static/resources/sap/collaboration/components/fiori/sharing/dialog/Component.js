/*!
 * @copyright@
 */
jQuery.sap.require("sap.collaboration.components.utils.OdataUtil");jQuery.sap.require("sap.collaboration.components.utils.CommonUtil");jQuery.sap.require("sap.ui.core.UIComponent");jQuery.sap.declare("sap.collaboration.components.fiori.sharing.dialog.Component");jQuery.sap.require("sap.m.MessageToast");sap.ui.core.UIComponent.extend("sap.collaboration.components.fiori.sharing.dialog.Component",{metadata:{properties:{width:{type:"sap.ui.core.CSSSize"},height:{type:"sap.ui.core.CSSSize"},oDataServiceUrl:{type:"sap.ui.core.URI",defaultValue:"/sap/opu/odata/sap/SM_INTEGRATION_SRV"},object:{type:"object"}},aggregations:{},events:{}},init:function(){this.oCommonUtil=new sap.collaboration.components.utils.CommonUtil();this.oLangBundle=this.oCommonUtil.getLanguageBundle()},setSettings:function(s){this.setODataServiceUrl(s.oDataServiceUrl);this.setObject(s.object)},createSharingComponent:function(){var o=this.getObject();var O=this.getODataServiceUrl();var s={oDataServiceUrl:O,object:o};if(!this.sharingComponent){this.sharingComponent=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing",id:this.getId()+"_SharingComponent"});this.sharingComponentContainer=new sap.ui.core.ComponentContainer(this.getId()+"SharingComponentContainer",{component:this.sharingComponent});this.sharingComponent.bOdataOn=false}this.sharingComponent.setSettings(s);try{this.sharingComponent.setGroupsData()}catch(e){this.oCommonUtil.displayError(e);this.bStopRendering=true}},createSharingDialog:function(){this.sResultMessage="";var s=this;var S=new sap.m.Dialog(this.getId()+"_SharingDialog",{title:this.oLangBundle.getText("SHARING_PAGE_TITLE"),stretch:false,content:[this.sharingComponentContainer],afterClose:function(){s.showMessage()}}).addStyleClass("sapUiPopupWithPadding");return S},open:function(){this.createSharingComponent();if(this.bStopRendering===undefined||this.bStopRendering===false){if(!this.oSharingDialog){this.oSharingDialog=this.createSharingDialog()}this.createDialogButtons();this.setDialogButtons();if(jQuery.device.is.phone){this.oSharingDialog.setStretch(true)}this.oSharingDialog.open()}},createDialogButtons:function(){var s=this;if(!sap.ui.getCore().byId(this.getId()+"_OkButton")){this.oOkButton=new sap.m.Button(this.getId()+"_OkButton",{text:this.oLangBundle.getText("OK_BUTTON_TEXT"),press:function(){s.oSharingDialog.getBeginButton().setEnabled(false);s.sResultMessage=s.sharingComponent.shareToJam();s.oSharingDialog.close()}})}if(!this.oCancelButton){this.oCancelButton=new sap.m.Button(this.getId()+"_CancelButton",{text:this.oLangBundle.getText("CANCEL_BUTTON_TEXT"),press:function(){s.oSharingDialog.close()}})}if(!this.oCloseButton){this.oCloseButton=new sap.m.Button(this.getId()+"_CloseButton",{text:this.oLangBundle.getText("CLOSE_BUTTON_TEXT"),press:function(){s.oSharingDialog.close()}})}},setDialogButtons:function(){if(this.sharingComponent.aJamGroups.length===0){this.oSharingDialog.destroyBeginButton();this.oSharingDialog.setEndButton(this.oCloseButton)}else{this.oSharingDialog.setBeginButton(this.oOkButton);this.oOkButton.setEnabled(true);this.oSharingDialog.setEndButton(this.oCancelButton)}},showMessage:function(){if(this.sResultMessage!==""){sap.m.MessageToast.show(this.sResultMessage,{duration:3000});this.sResultMessage=""}}});
